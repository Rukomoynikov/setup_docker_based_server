---

- name: Install required system packages
  apt:
    pkg:
      - apt-transport-https
      - ca-certificates
      - software-properties-common
      - python3-pip
      - python3-setuptools
    state: latest
    update_cache: true
- name: Get local IP address (public one)
  shell: ip addr show eth0 | grep "inet\b" | awk '{print $2}' | cut -d/ -f1 | tail -n 1
  register: local_ip
- name: Init a new swarm with default parameters
  shell: |
    docker swarm init --addvertise-address={{local_ip.stdout}}
